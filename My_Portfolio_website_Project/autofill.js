/*!
 * @package Autofill
 * @author T. H. Doan
 * @copyright (c) 2010-2023
 * @link https://www.tohodo.com/
 */
var e=document,t=chrome.runtime.getManifest().name,n="Backup - ",r=t+" "+chrome.i18n.getMessage("wizardUpdateAlert"),a="input:not([type=button]):not([type=image]):not([type=reset]):not([type=submit])",i=a+",select,textarea,[contenteditable=true]",l=i+",iframe,div[jsaction][aria-checked],div[jsaction][aria-selected]",o="data-autofill-highlight",c=location.host?location.host.replace(/^www\d*?\./,""):location.pathname.replace(/^.+?(\/)(.+\/)?.+$/,"$1$2"),s="",u=e.title+"\n"+e.URL+(0===e.URL.indexOf("http")?"\n"+e.URL.replace(/(:\/\/)(www\d*?\.)?/,e.URL.indexOf("://www")<0?"$1www.":"$1"):""),f=window.location!==window.parent.location?e.referrer:e.location.href,d=[],p,h,v,g,m,b,y,w,x,E,k,A,L=!1,N=new Map,C=function(e){return e.classList.contains("quantumWizTextinputPaperinputInput")||e.classList.contains("quantumWizMenuPaperselectOption")},O=function(e){return e.classList.contains("office-form-question-textbox")},I=1===e.querySelectorAll("form#new_request[data-form-type=request]").length,S=U((function(e){if(b)for(var t,n,r=0;r<b.cats.length;++r)if(b.cats[r].h){n=!0,t=b.cats[r].h.split(" + ");for(var a=0;a<t.length;++a)switch(t[a]){case"Ctrl":e.ctrlKey||(n=!1);break;case"Shift":e.shiftKey||(n=!1);break;case"Alt":case"Option":e.altKey||(n=!1);break;case"Win":case"âŒ˜":e.metaKey||(n=!1);break;default:t[a].replace(/ /g,"").replace(/^Space$/," ").toUpperCase()!==(e.key||"").toUpperCase()&&(n=!1)}if(n)return void ve({type:"executeRules",data:{catnow:r+5}})}}));function R(){return new Promise((function(n,r){chrome.storage.local.get((function(a){var i=chrome.runtime.lastError;if(i)r(i.message);else{x=!!(b=a).other.activecat,E=!!b.other.debug,k=!1;for(var l=0;l<a.exceptions.length;++l){try{re=new RegExp(a.exceptions[l],"im")}catch(e){E&&console.warn("["+t+"] Exception "+a.exceptions[l]+" is invalid. Skipping..."),re=/^\b$/}if(re.test(u))return k=!0,e.removeEventListener("keydown",S),void r("Autofilling is disabled for "+e.URL+" because "+(self===top?"this page":"the parent frame")+' matches "'+a.exceptions[l]+'" on the Exceptions list.')}var o=JSON.parse(b.rules),f=location.host?c+location.pathname:location.pathname.replace(/^.+?\//,"/");if(s=location.host?c:f.replace(/(.+)\/.+$/,"$1"),b.other.sitefilters)switch(b.sitefilters){case 0:s=f;break;case 1:s=f+location.search;break;case 2:s=f+location.search+location.hash}s=P(s),g={};for(l=0;l<b.cats.length;++l)g[b.cats[l].k]={n:b.cats[l].n,s:b.cats[l].s};v={};var d,p;for(l=0;l<b.advanced.length;++l)if((d=b.advanced[l].split(":"))[0]=d[0].trim().toLowerCase(),2===d.length&&(g[d[0]]||o[d[0]])){p=d[1].trim().split(/ +/);for(var y,w,L,N=0;N<p.length;++N)if(!(p[N].indexOf("=")<1))if(w=(y=p[N].split("="))[0].toLowerCase(),L=y[1].toLowerCase(),"delay"===w){if(L=+L,isNaN(L)||L<=0)continue;v[d[0]]||(v[d[0]]={}),v[d[0]][w]=L}else"all"!==w&&"forcefill"!==w||"true"!==y[1]||(v[d[0]]||(v[d[0]]={}),v[d[0]][w]=!0)}for(var C in h=_(b.catnow),b.rules={},o)re=new RegExp(se(o[C].s)||g[o[C].c]&&g[o[C].c].s||".","im"),re.test(u)&&(b.rules[C]=o[C],b.other.manual&&(v[C]&&v[C].forcefill||v[b.rules[C].c]&&v[b.rules[C].c].forcefill)&&(m||(m={}),m[C]=o[C]));o=void 0,b.other.manual||(m=void 0),A=!(!b.other.manual||v[h]&&v[h].forcefill||m),e.getElementById("autofill-wizard")&&Wizard.updateCats(),e.addEventListener("keydown",S),e.dispatchEvent(new Event("init")),n()}}))}))}function T(e,t){if(e)for(var n=0;n<e.length;++n){var r=e[n],a=r.type;if(!(r.disabled||r.hidden||r.readOnly||"hidden"===a||"DIV"===r.nodeName&&r.hasAttribute("aria-checked")||"SELECT"===r.nodeName&&I))if(r.backup=b.other.backup&&"password"!==a,"IFRAME"===r.nodeName){if(!be(r))continue;r.sync=t,r.onload=function(){T([this],this.sync)};var i=ee(r);i instanceof Array?T(i,t):"string"==typeof i&&M(r,i)}else if("DIV"===r.nodeName&&"true"===r.getAttribute("aria-selected"))r.parentNode.initialValue=(r.getAttribute("data-value")||"").trim();else{if(!t){var l=N.get(r);"checkbox"===a||"radio"===a?void 0===l?(r.initialValue=r.checked,N.set(r,r.initialValue)):r.initialValue=l:r.multiple?void 0===l?(r.initialValue=le(r),N.set(r,r.initialValue)):r.initialValue=l:(r.isContentEditable?M(r,G(r.innerHTML)):void 0===l?(r.initialValue=r.value,N.set(r,r.initialValue)):r.initialValue=l,r.initialClass="string"==typeof r.className?r.className.trim():"")}r.backup?r.addEventListener("input",j):r.removeEventListener("input",j)}}}function M(e,t){if(void 0===e.timer||e.sync){var n,r,a=0,i=0;e.initialValue=t,e.timer=setInterval((function(e){if(e.isContentEditable)n=e,r=!0;else try{n=e.contentDocument&&e.contentDocument.body,r=e.contentDocument&&"complete"===e.contentDocument.readyState}catch(t){return void clearInterval(e.timer)}if(n)if(e.sync||r&&G(n.innerHTML)===e.initialValue){if(e.sync||3==++i)return clearInterval(e.timer),e.isContentEditable||(e.backup?n.addEventListener("input",j):n.removeEventListener("input",j),n.setAttribute(o,"false"),n.addEventListener("blur",xe),n.addEventListener("focus",Ee)),e.done=!0,void(e.sync||e.dispatchEvent(new Event("done")))}else e.sync||(e.initialValue=G(n.innerHTML)),i=0;100==++a&&clearInterval(e.timer)}),100,e)}}function Autofill(t,r,a,i){if("string"!=typeof t){var o=i||(m||b.rules);if(0!==Object.keys(o).length){var s,u,f,p,y,w,E,k,A,N,I,S={},R={},T={},M=[],$=[],V=0,q="abcdefghijklmnopqrstuvwxyz",j="0123456789",H=q+q.toUpperCase()+j+j,F=function(e,t,n){if(e&&(void 0!==e.type||e.innerHTML!==t)){var r=void 0===e.value?e.innerHTML:e.value;switch(void 0===e.afMode?E.o:e.afMode){case 2:t+=r;break;case 3:t=r+t;break;case 4:t=t+r+t;break;case 5:t=isNaN(r)?r:++r;break;case 6:t=isNaN(r)?r:--r}e.focus({preventScroll:!0}),void 0===e.value?e.innerHTML=t:e.value=t,J(e,["keydown","keypress","input","keyup"]),fe(n,e),++V}},U=function(t){if(t.id)try{if((r=e.querySelector('[for="'+W(t.id)+'"]'))&&I.test(r.textContent.trim()))return!0}catch(e){}var n,r,a=t.getAttribute("aria-labelledby")||t.getAttribute("aria-describedby");if(a&&((r=e.getElementById(a))&&I.test(r.textContent.trim())))return!0;if(C(t)&&((r=(n=ie(t,"[role=listitem]"))&&n.querySelector(".freebirdFormviewerComponentsQuestionBaseHeader"))&&I.test(r.innerText.replace(/^ *(.+?) *$/gm,"$1"))&&(t.classList.contains("quantumWizTextinputPaperinputInput")||p===(t.getAttribute("data-value")||"").trim())))return!0;if(O(t)&&((r=(n=ie(t,".office-form-question-content"))&&n.querySelector(".text-format-content"))&&I.test(r.textContent.trim())))return!0;var i=(t.getAttribute("aria-label")||"").trim()+"\n"+(t.name||"").trim()+"\n"+t.id.trim()+"\n"+(t.getAttribute("aria-labelledby")||"").trim()+"\n"+(t.getAttribute("aria-describedby")||"").trim()+"\n"+(t.getAttribute("data-bind")||"").trim()+"\n"+(t.getAttribute("data-reactid")||"").trim()+"\n"+(t.getAttribute("ng-model")||"").trim()+"\n"+t.title.trim()+"\n"+(t.placeholder||"").trim()+"\n"+(t.initialClass||"")+"\n"+("string"==typeof t.className?t.className.trim():"");if("checkbox"!==t.type&&"radio"!==t.type||"on"===t.value?t.src&&0===t.src.indexOf(location.origin)&&t.src!==e.URL&&(i+="\n"+t.src):i+="\n"+t.value.trim(),I.test(i))return!0;if(t.parentNode&&"LABEL"===t.parentNode.nodeName&&I.test(t.parentNode.textContent.trim()))return!0;try{return t===e.querySelector(f.replace(/\\/g,""))}catch(e){}return!1},z=function(e,t){if(b.other.vars){var n,r,a,i=e;if(e=se(e),4===E.t)return e;if((a=/\{[nv]\d+\}/g).test(e)){var l,o,c;n=e.match(a);for(var s=0;s<n.length;++s)a=new RegExp(n[s]),l=n[s].replace(/\D+/g,""),o=n[s].slice(1,2),b.rules["r"+l]&&void 0!==b.rules["r"+l][o]&&(c="v"===o&&T["r"+l]?T["r"+l]:b.rules["r"+l][o],e=e.replace(a,c))}if(t)return e;if((a=/\{-?\d+(\+\+|\+\d+|--|-\d+)\}/g).test(e)){n=e.match(a);var u,f;for(s=0;s<n.length;++s)a=new RegExp(n[s].replace(/(\+\+|\+\d+|--|-\d+)/,"($1)").replace(/\+/g,"\\+")),u=+n[s].replace(/\{(-?\d+).+/,"$1"),f=n[s].indexOf("++")>0?1:n[s].indexOf("--")>0?-1:+n[s].replace(/.+?([+-]\d+).+/,"$1"),e=e.replace(a,u+f),i=i.replace(a,"{``"+(u+f)+"``$1}");E.v=i.replace(/``(\d+)``/g,"$1"),M.push({key:Q,obj:E})}if((a=/\{[#$]\d*\}/g).test(e)){var d,p;n=e.match(a);for(s=0;s<n.length;++s){if(a=new RegExp(n[s].replace("$","\\$")),d=+n[s].replace(/\D/g,"")||1,n[s].indexOf("#")>0){p=pe(1,9);for(var h=1;h<d;++h)p+=pe(0,9)+""}else{p=H.charAt(pe(0,51));for(h=1;h<d;++h)p+=H.charAt(pe(0,H.length-1))}e=e.replace(a,p)}}var v="(?:(?:[^|\\\\{}(),]|(?:\\\\[{}|(),]))+(?:\\|(?:[^|\\\\{}(),]|(?:\\\\[{}|(),]))+)+)";if((a=new RegExp("\\{"+v+"\\}","g")).test(e)){n=e.match(a);for(s=0;s<n.length;++s)a=new RegExp(P(n[s])),r=n[s].substring(1,n[s].length-1).split(/(?<!\\)\|/),e=e.replace(a,r[pe(0,r.length-1)].replace(/\\(?!\\)/g,""))}if((a=new RegExp("\\{\\("+v.replace("+)+","+)*")+"\\)\\}","g")).test(e)){n=e.match(a);var g;for(s=0;s<n.length;++s)a=new RegExp(P(n[s])),g=pe(0,(r=n[s].substring(2,n[s].length-2).split(/(?<!\\)\|/)).length-1),e=e.replace(a,r[g].replace(/\\(?!\\)/g,"")),r.splice(g,1),i=i.replace(a,"{``("+r.join("|")+")``}");E.v=i.replace(/``(\([^)]+\))``/g,"$1").replace(/{``\(\)``}/g,""),M.push({key:Q,obj:E})}var m="(?:(?:[^|\\\\{}(),]|(?:\\\\[{}|(),]))+(?:,(?:[^|\\\\{}(),]|(?:\\\\[{}|(),]))+)+)";if((a=new RegExp("\\{"+m+"\\}","g")).test(e)){n=e.match(a);var y;for(s=0;s<n.length;++s)a=new RegExp(P(n[s])),r=(y=n[s].substring(1,n[s].length-1)).split(/(?<!\\),/),E.hasOwnProperty(y)||(E[y]=0),e=e.replace(a,r[E[y]].replace(/\\(?!\\)/g,"")),void 0===r[++E[y]]&&(E[y]=0);M.push({key:Q,obj:E})}if((a=new RegExp("\\{\\("+m.replace("+)+","+)*")+"\\)\\}","g")).test(e)){n=e.match(a);for(s=0;s<n.length;++s)a=new RegExp(P(n[s])),r=n[s].substring(2,n[s].length-2).split(/(?<!\\),/),e=e.replace(a,r[0].replace(/\\(?!\\)/g,"")),r.shift(),i=i.replace(a,"{``("+r.join(",")+")``}");E.v=i.replace(/``(\([^)]+\))``/g,"$1").replace(/{``\(\)``}/g,""),M.push({key:Q,obj:E})}}return e};if(!(t instanceof Array)){t=de(l);for(he=0;he<d.length;++he)t.indexOf(d[he])<0&&t.push(d[he])}if(k=t.length,b.other.attributesoff){var K=b.attributesoff.split(/ *,? */);for(he=0;he<K.length;++he)for(var _=0;_<t.length;++_)t[_].removeAttribute(K[he])}for(var Q in e.autofilling=performance.now(),o)r?g[o[Q].c]&&g[o[Q].c].n===n+c&&(R[Q]=o[Q]):x&&"all"!==h?(o[Q].c===h||v[o[Q].c]&&v[o[Q].c].all||v[Q]&&v[Q].all)&&(R[Q]=o[Q]):(""===o[Q].c||g[o[Q].c]&&g[o[Q].c].n.indexOf(n)<0)&&(R[Q]=o[Q]);if(0!==Object.keys(R).length){r||a||t.push(e.createElement("input"));for(he=0;he<t.length;++he)if(A="DIV"===(s=t[he]).nodeName&&s.getAttribute("aria-checked")||null,N="DIV"===s.nodeName&&s.getAttribute("aria-selected")||null,!s.disabled&&!s.readOnly)for(var Q in u=s.type,R)if(E=R[Q],i||!(v[E.c]&&v[E.c].delay||v[Q]&&v[Q].delay)){switch(E.t){case 0:if("password"===u||"checkbox"===u||"radio"===u||"SELECT"===s.nodeName||null!==A||null!==N)continue;break;case 1:if("password"!==u)continue;break;case 2:if("SELECT"!==s.nodeName&&null===N)continue;break;case 3:if("checkbox"!==u&&"radio"!==u&&null===A)continue}f=z(E.n,!0),p=E.v;try{I=new RegExp(f.replace(/\/\*.*?\*\/\s*/g,"")||".","im")}catch(e){I=/^\b$/}switch(E.t){case 2:if(U(s))if("SELECT"===s.nodeName){var Y=function(){var e=s.id&&s.nextElementSibling;e&&e.id===s.id+"-button"&&e.children[1]&&"ui-selectmenu-text"===e.children[1].className&&(e.children[1].textContent=s[s.selectedIndex].text||""),J(s,["input"]),fe(Q,s),++V};if(s.dispatchEvent(new Event("focus")),"?"===(p=z(p).trim().toLowerCase()))s.selectedIndex=pe(0,s.options.length-1),Y();else if(/^([01]?!|)$/.test(p)){for(var X=0;X<s.length;++X)switch("!"===p||"1!"===p){case!0:s[X].selected||(s[X].selected=!0);break;case!1:s[X].selected&&(s[X].selected=!1)}Y()}else if(isNaN(p)){if(s.multiple){/[^\d ]/.test(p)||(p=p.replace(/ +/g,"|")),/[^\d |]/.test(p)||(p=p.replace(/ +/g,""));var Z=/^[\d+](\|\d+)*$/.test(p)?p.split("|"):p.match(/(?<!\\)".*?(?<!\\)"/g),G=!1;null===Z&&(Z=['"'+p+'"']);var ee,te;for(X=0;X<s.length;++X)ee='"'+s[X].value.toLowerCase().replace(/"/g,'\\"')+'"',te='"'+(s[X].text||"").toLowerCase().replace(/"/g,'\\"')+'"',s[X].selected?Z.indexOf(X+"")<0&&Z.indexOf(ee)<0&&Z.indexOf(te)<0&&(s[X].selected=!1,G=!0):(Z.indexOf(X+"")>-1||Z.indexOf(ee)>-1||Z.indexOf(te)>-1)&&(s[X].selected=!0,G=!0);G&&Y()}else if(p=(p=p.replace(/(?<!\\)"/g,"")).replace(/\\"/g,'"'),s.value.toLowerCase()!==p)for(X=0;X<s.length;++X)if(p===s[X].value.toLowerCase()||p===(s[X].text||"").toLowerCase()){s[X].selected=!0,Y();break}}else s.selectedIndex!=p&&(s.selectedIndex=+p,s.selectedIndex==p&&Y())}else if(null!==N){var ne;s.afLI=ie(s,'[role="listitem"]'),s.afRule=Q,s.afValue=p,s.afTick=0,s.timer=setInterval((function(e){e.afLI&&!L&&(L=!0,e.click(),clearInterval(e.timer),e.timer=setInterval((function(e){(ne=e.afLI.querySelectorAll('[data-value="'+e.afValue+'"]')[1])&&(ne.click(),L=!1,fe(e.afRule,e),me(0,1)),(ne||100==++e.afTick)&&clearInterval(e.timer)}),50,e)),100==++e.afTick&&clearInterval(e.timer)}),50,s)}break;case 3:if(U(s))if("?"===(y=z(p).replace(/\s+/g,"")))switch(s.type){case"checkbox":V+=ge(s,pe(0,1),Q,A);break;case"radio":if(f=f.replace(/[\^\$]/g,""),$.indexOf("["+f+"]")<0){var re=de("input[type=radio]"+(f?'[name="'+W(f)+'"]':""));V+=ge(re[pe(0,re.length-1)],1,Q,A),$.push("["+f+"]")}}else y.length>1&&y.indexOf("!")<0?(void 0===S[f]?S[f]=0:++S[f],S[f]<y.length&&ge(s,+y.charAt(S[f]),Q,A),y.length===S[f]+1&&++V):V+=ge(s,parseInt(y),Q,A);break;case 4:void 0===w&&(w={}),w[Q]=z(p);break;default:if("INPUT"===s.nodeName||"TEXTAREA"===s.nodeName){if(b.other.skiphidden&&null===s.offsetParent)continue;!E.o&&s.value||!U(s)||(F(s,z(p),Q),b.other.vars&&p.indexOf("{")>-1&&(T[Q]=s.value))}else{var ae="IFRAME"===s.nodeName;if(!ae&&!s.isContentEditable||ae&&!be(s)||!U(s))continue;if(void 0===s.done){if(void 0!==s.afMode)continue;s.afMode=E.o,s.afRule=Q,s.afValue=z(p),s.addEventListener("done",(function(){var t="IFRAME"===this.nodeName?this.contentDocument.body:this;!this.afMode&&D(t.innerHTML)||(F(t,this.afValue,this.afRule),r||(e.autofilled=performance.now(),me(0,1)))}),{once:!0})}else{var le=ae?s.contentDocument.body:s;!E.o&&D(le.innerHTML)||F(le,z(p),Q)}}}}if(!r){var oe;if(e.autofilled=performance.now(),delete e.autofilling,w&&!a&&("complete"===e.readyState?V+=B(w):window.addEventListener("load",function(e){return function(){me(0,B(e))}}(w))),!i)for(var Q in R)if(oe=v[Q]&&v[Q].delay||v[R[Q].c]&&v[R[Q].c].delay||0){var ce={};ce[Q]=R[Q],setTimeout((function(e){Autofill(null,null,null,e)}),1e3*oe,ce)}M.length&&chrome.storage.local.get("rules",(function(e){if(!chrome.runtime.lastError){for(var t=JSON.parse(e.rules),n=0;n<M.length;++n)t[M[n].key]=M[n].obj;chrome.storage.local.set({rules:JSON.stringify(t)})}})),me(k,V)}}}}else{var ue;switch(t){case"":ue=2;break;case"all":ue=1;break;default:for(var he=0;he<b.cats.length;++he)if(b.cats[he].k===t){ue=he+5;break}}if(ue)var ye=setInterval((function(t){performance.now()-e.autofilled>200&&(clearInterval(ye),setTimeout((function(e){ve({type:"executeRules",data:{catnow:e}})}),t.delay,t.catnow))}),100,{catnow:ue,delay:"number"==typeof r?r:0})}}function V(e){if(!y)return[];var t,n;if(te(),C(y)?t=Z(y):O(y)&&(t=ne(y)),t||(t=ae(y)),void 0!==y.type)n=y.value;else if(y.isContentEditable)n=G(y.innerHTML);else if("IFRAME"===y.nodeName&&"string"!=typeof(n=ee(y)))return[];return t&&n!==y.initialValue?[{t:"password"===y.type?1:0,n:t,v:n,s,c:e}]:[]}function q(e,t){var n,r,i,l=":not([disabled]):not([hidden]):not([readonly])",o=[],u=de(a+l,t),f=de("select"+l,t),d=de("textarea"+l,t),p=de("[contenteditable=true]",t),h=de("iframe",t),v=de("div[jsaction][aria-selected=true]",t),g=de("div[jsaction][aria-checked=true]",t);te();for(var m=0;m<u.length;++m)if(r="",n=(A=u[m]).type,i=A.value,("file"!==n||i)&&"hidden"!==n&&0!==A.parentNode.id.indexOf("autofill-")&&("password"!==n&&"checkbox"!==n&&"radio"!==n&&(n="text"),("text"!==n&&"password"!==n||i!==A.initialValue)&&("checkbox"!==n&&"radio"!==n||A.checked!==A.initialValue)))switch(C(A)?r=Z(A):O(A)&&(r=ne(A)),r||(r=ae(A)),n){case"text":r&&o.push({t:0,n:r,v:i,s,c:e});break;case"password":o.push({t:1,n:r,v:i,s,c:e});break;default:"checkbox"!==n&&"radio"!==n||o.push({t:3,n:r,v:new RegExp(r).test(A.name)?Q(A):+A.checked+"",s,c:e})}for(m=0;m<f.length;++m)if(((A=f[m]).multiple?le(A):A.value)!==A.initialValue&&0!==A.parentNode.id.indexOf("autofill-")&&(r=ae(A))){if(A.multiple){i="";for(var y=0,w=A.length,x=0;y<w;++y)A[y].selected&&(i+='|"'+(A[y].value||A[y].text||"").replace(/"/g,'\\"')+'"',++x),y===w-1&&x===w&&(i="1!");i=i.slice(1)}else i='"'+(A.value||A.text||"").replace(/"/g,'\\"')+'"';o.push({t:2,n:r,v:i,s,c:e})}for(m=0;m<d.length;++m)r="",(i=(A=d[m]).value)!==A.initialValue&&null!==A.offsetParent&&(O(A)&&(r=ne(A)),r||(r=ae(A)),r&&o.push({t:0,n:r,v:i,s,c:e}));for(m=0;m<p.length;++m)(i=G((A=p[m]).innerHTML))!==A.initialValue&&(r=ae(A))&&o.push({t:0,n:r,v:i,s,c:e});for(m=0;m<h.length;++m)if((i=ee(A=h[m]))instanceof Array){var E=q(e,A.contentDocument);E.length&&(o=o.concat(E))}else{if(void 0===i||i===A.initialValue)continue;if(r=ae(A)){if(b.other.sitefilters&&self!==top&&top.origin.indexOf(c)>-1){var k=X(s,top.location.host.replace(/^www\d*?\./,"")+top.location.pathname);k&&(s=P(k))}o.push({t:0,n:r,v:i,s,c:e})}}for(m=0;m<v.length;++m)(i=((A=v[m]).getAttribute("data-value")||"").trim())&&i!==A.parentNode.initialValue&&!A.classList.contains("isPlaceholder")&&(r=Z(A)||ae(A))&&o.push({t:2,n:r,v:i,s,c:e});var A;for(m=0;m<g.length;++m)(r=ae(A=g[m]))&&o.push({t:3,n:r,v:"1",s,c:e});return o}function j(e){if(b.other.backup&&e.inputType&&(y=e.target.matches(i)?e.target:e.target.ownerDocument.defaultView.frameElement)){var t=y.contentDocument;if(!((t&&t.body?G(t.body.innerHTML):y.value||G(y.innerHTML)).length<b.backup)){for(var r,a=n+c,l=!0,o=0;o<b.cats.length;++o)if(b.cats[o].n===a){r=b.cats[o].k,l=!1;break}l?ve({type:"saveCat",data:{backup:!0,cat:{n:a,s}}},(function(e){he(e.cat)})):he(r)}}}function D(e){return e.replace(/\s|<.+?>|&nbsp;/gi,"")}function H(){w&&(w.initialStyle?w.setAttribute("style",w.initialStyle):w.removeAttribute("style"),delete w.initialStyle)}function F(t){t.observer||(t.observer=new MutationObserver((function(t){t.forEach((function(t){for(var n,r=[],a=0;a<t.addedNodes.length;++a)if(1===(n=t.addedNodes[a]).nodeType&&"autofill-wizard"!==n.id&&!/HEAD|LINK|SCRIPT|STYLE|TITLE/.test(n.nodeName)&&("IFRAME"!==n.nodeName||be(n)))if(n.children&&n.children.length){r=de(l,n);for(var i=0;i<r.length;++i)(void 0!==r[i].initialValue||d.indexOf(r[i])>-1)&&r.splice(i,1)}else n.matches(l)&&d.indexOf(n)<0&&r.push(n);r.length&&(me(r.length,0),T(r),d=d.concat(r),Autofill(r,!0,!0),e.autofilling&&!A&&Autofill(r,!1,!0))}))})),t.observer.observe(t.body||t,{childList:!0,subtree:!0}))}function U(e){var t;return function(){var n=this,r=arguments;clearTimeout(t),t=setTimeout((function(){e.apply(n,r)}),50)}}function z(e){var t=e.replace(/[\r\n]+/g," ").trim().replace(/ +/g,".").replace(/([^\w.,>~#+-])/g,"\\$1").replace(/\b(\d+)\.(\d+)\b/g,"$1\\.$2");return t?"."+t:null}function P(e){return e.replace(/([$^?+*\\|(){}\[\]])/g,"\\$1")}function W(e){return e.replace(/("|\\)/g,"\\$1").replace(/[\r\n]+/g," ")}function B(n){var r=0;for(var a in n)try{eval(n[a]),fe(a,n[a]),++r}catch(r){E&&console.warn("["+t+"] The following JavaScript code was not executed:\n\n"+n[a]+"\n\nError: "+r.message+"\nFrame: "+e.URL)}return r}function J(t,n,r){if(!t.isContentEditable){if(void 0===t.value)return;n.push("change")}r=r||t.classList.contains("wym_iframe");for(var a=0;a<n.length;++a)t.dispatchEvent(new Event(n[a],{bubbles:!r}));e.activeElement.blur()}function K(e){if(!(e[0]instanceof Array))return[];var t=[],n=function(r,a){for(var i=0;i<e[a].length;++i){var l=r.slice(0);l.push(e[a][i]),a===e.length-1?t.push(l):n(l,a+1)}};return n([],0),t}function _(e){return e>2?b.cats[e-5].k:1===e?"all":""}function Q(t){if(!t.name)return"";for(var n=e.getElementsByName(t.name),r="",a=0;a<n.length;++a)r+=+n[a].checked+"";return r}function Y(e){var t=function(e,n,r){return 0===e.length&&0===n.length?[]:(0===n.length?r.push(e):(t(e.concat(n[0]),n.slice(1),r),t(e,n.slice(1),r)),r.sort((function(e,t){return e.length-t.length})))};return t([],e,[])}function X(e,t){for(;-1===e.indexOf(t)||"/"!==t.slice(-1);)t=t.slice(0,-1);return t}function Z(e){var t,n=ie(e,"[role=listitem]");if(n&&1===n.querySelectorAll("input,[aria-selected=true]").length){var r=n.querySelector("[role=heading]");if(r){var a=r.textContent.trim();ye(p,a)&&(t="^"+P(a)+"$")}}return t}function G(e){return D(e=e.replace(/<script.+?<\/script>/gi,""))?e.trim():""}function ee(e){if(be(e))try{var t=e.contentDocument,n=t&&t.body&&de(i,t.body);return n&&n.length?n:t&&t.body?G(t.body.innerHTML):void F(t)}catch(e){return}}function te(){p=[],e.querySelectorAll("[role=heading].freebirdFormviewerComponentsQuestionBaseTitle,.office-form-question-title .text-format-content").forEach((function(e){p.push(e.textContent.trim())}))}function ne(e){var t,n=ie(e,".office-form-question-content");if(n){var r=n.querySelector(".text-format-content");if(r){var a=r.textContent.trim();ye(p,a)&&(t="^"+P(a)+"$")}}return t}function ae(n){var r="^"+P(oe(n,"aria-label")||("checkbox"!==n.type&&"radio"!==n.type||void 0===n.value?"":oe(n,"value"))||n.name||n.id||oe(n,"aria-labelledby")||oe(n,"aria-describedby")||oe(n,"data-bind")||oe(n,"data-reactid")||oe(n,"ng-model")||oe(n,"title")||oe(n,"placeholder")||(n.src&&0===n.src.indexOf(location.origin)&&n.src!==e.URL?n.src:"")||"").trim()+"$",a=[];if("^$"===r){r=(n.initialClass||n.className||"").trim();try{a=e.querySelectorAll(z(r))}catch(e){E&&console.warn("["+t+"] "+e)}r=r&&r.indexOf("quantumWizMenuPaperselectOption")<0&&1===a.length?"\\b"+r+"\\b":ce(n)}return r}function ie(e,t){if(t&&"string"==typeof t){for(;e=e.parentElement;)if(e.matches(t))return e;return null}return e.parentElement}function le(e){for(var t=[],n=e.selectedOptions||[],r=0;r<n.length;++r)t.push(n[r].value||n[r].text||"");return JSON.stringify(t)}function oe(t,n){var r,a=t.getAttribute(n);return a&&(r=e.querySelectorAll("["+n+'="'+W(a)+'"]').length,self!==top&&top.origin.indexOf(c)>-1&&(r+=top.document.querySelectorAll("["+n+'="'+W(a)+'"]').length)),1===r?a:void 0}function ce(n){if(n instanceof Element){for(var r,a,i=n,l=[],o=function(e,t){var n,r=e.nodeName.toLowerCase();l.unshift([]),e.id&&l[0].push("#"+e.id),l.length>1&&l[0].push(r),e.hasAttribute("aria-label")&&e.hasAttribute("aria-describedby")&&(n='[aria-label="'+W(e.getAttribute("aria-label"))+'"][aria-describedby="'+W(e.getAttribute("aria-describedby"))+'"]',l[0].push(n,r+n));var i=e.className.replace(/\bis(Checked|Selected)\b/g,"").trim();i&&(i=z(i),l[0].push(i,r+i));for(var o,s,u=Y(e.getAttributeNames().filter((function(e){return"id"!==e&&"class"!==e&&!/[^\w-]/.test(e)}))),f=0;f<u.length;++f)for(var d=0;d<u[f].length;++d)o=u[f][d],(s=e.getAttribute(o)).indexOf("\n")>-1&&(s=""),n="["+o+(s?'="'+W(s)+'"':"")+"]",l[0].push(n,r+n),i&&l[0].push(n+i,r+n+i);if(t){for(var p=e,h=1;p=p.previousElementSibling;)p.nodeName===e.nodeName&&++h;var v=":nth-of-type("+h+")";for(l[0].push(r+v),i&&l[0].push(r+i+v),p=e,h=1;p=p.previousElementSibling;)++h;v=h>1?h===e.parentElement.children.length?":last-child":":nth-child("+h+")":":first-child",l[0].push(r+v),i&&l[0].push(r+i+v)}if(1===l.length){for(f=0;f<l[0].length;++f)if(c([l[0][f]]))return[l[0][f]]}else{for(f=0;f<l.length;++f)if(l[f].length>500)return;a=K(l);for(f=0;f<a.length;++f)if(c(a[f]))return a[f]}},c=function(n){var r=[];try{r=e.querySelectorAll(n.join(">")||null)}catch(e){E&&console.warn("["+t+"] "+e)}return 1===r.length};n.parentElement;){if(r=o(n))return P(r.join(" > "));if((n=n.parentElement)===e.body)break}for(n=i,l=[];n.parentElement;){if(r=o(n,!0))return P(r.join(" > "));if((n=n.parentElement)===e.body)break}return""}}function se(e){if(b.variables.length&&(reVar=/\{@(\w+)\}/g).test(e)){aMatches=e.match(reVar);for(var t=0;t<aMatches.length;++t)for(var n=0,r,a;n<b.variables.length;++n)if("#"!==b.variables[n][0]&&(r=b.variables[n].match(/^(\w+) = (.+)$/),r&&(r=r.slice(1),aMatches[t]==="{@"+r[0]+"}"))){if(reVar=new RegExp("{@"+r[0]+"}","g"),a="",r[1].indexOf("javascript:")>-1)try{a=eval(r[1].replace("javascript:",""))}catch(e){}else a=r[1].replace(/\\=/g,"=").replace(/\\n/g,"\n");e=e.replace(reVar,a);break}}return e}function ue(e){if("false"!==e.getAttribute(o)){var t;if(!e.type)if("IFRAME"===e.nodeName)(e=be(e)&&(t=e.contentDocument)&&t.activeElement||null)&&!e.matches(i)&&(e=e.ownerDocument.defaultView.frameElement||null);else for(;e&&"BODY"!==e.nodeName&&"true"!==e.getAttribute("contenteditable");)e=e.parentNode;return e&&(w="IFRAME"===e.nodeName?t&&t.body:e)&&void 0===w.initialStyle&&(w.initialStyle=w.getAttribute("style"),setTimeout((function(){w.setAttribute("style","background:#cadbf2!important")}),0)),e}}function injectJquery(){return new Promise((function(e,n){try{ve({type:"injectJquery"},(function(n){window.$&&(E&&console.log("["+t+"] jQuery v"+$().jquery+" loaded."),e())}))}catch(e){n(e)}}))}function fe(e,n){if(E){var r="["+t+"] Rule "+e.replace("r","n")+' in profile "'+(g[b.rules[e].c]?g[b.rules[e].c].n:"Unfiled")+'"';"string"==typeof n?console.log(r+" executed this JavaScript:\n\n"+n+"\n\n"):console.log(r+" autofilled this field:",n)}}function de(t,n){return[].slice.call((n||e).querySelectorAll(t))}function pe(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function he(e){var t=V(e);t.length&&(ve({type:"saveRules",data:{backup:!0,rules:t}}),y=void 0)}function ve(t,n,a){try{chrome.runtime.sendMessage(t,"function"==typeof n?n:function(e){chrome.runtime.lastError})}catch(t){a&&"beforeunload"===a.type||!e.getElementById("autofill-wizard")||alert(r)}}function ge(e,t,n,r){var a,i=0;if("boolean"==typeof e.checked)a=e.checked;else{if(null===r)return 0;a="true"===r}switch(t){case 0:a&&(e.click(),fe(n,e),++i);break;case 1:a||(e.click(),fe(n,e),++i)}return i}function me(e,t){ve({type:"updateStatus",data:{fields:e,filled:t}})}function be(e){try{return e.offsetParent&&e.clientWidth>1&&e.clientHeight>1&&(!e.src||0===e.src.indexOf(location.origin)||/^(about|javascript)/i.test(e.src))&&(!e.contentDocument||!e.contentDocument.querySelector(a+",select,iframe"))}catch(e){return!1}}function ye(e,t){return 1===e.filter((function(e){return e===t})).length}function we(e){ve({type:"resetCounters",data:{force:!0}},null,e)}function xe(){this.setAttribute(o,"false")}function Ee(){this.setAttribute(o,"true")}function ke(n,r,a){switch(n.type){case"autofill":if(k)E&&console.warn("["+t+"] Autofilling is disabled for this page because it is on the Exceptions list.");else if(b){var i=function(){x=!0,A=!0,m=void 0,h=_(n.catnow),Autofill()};n.catnow===b.catnow?i():e.addEventListener("init",i,{once:!0})}break;case"clearHighlight":H();break;case"create":var o=y?V(n.cat):null===y?[]:q(n.cat);o.length&&ve({type:"appendRules",data:o}),a({field:!!y});break;case"insertText":var c=e.activeElement;if("BODY"===c.nodeName||"IFRAME"===c.nodeName)return;chrome.storage.local.get("textclips",(function(t){if(!chrome.runtime.lastError)for(var r=t.textclips,a=0;a<r.length;++a)if(n.id===r[a].trim().split("\n")[0].replace(/ *> *|\W/g,"_").toLowerCase()){if(r[a]=r[a].replace(/\r?\n/g,"\n").replace(/\s*.+\n/,""),c.isContentEditable){var i=e.createElement("span"),l=getSelection().getRangeAt(0);l.deleteContents(),i.innerHTML=r[a].replace(/\n/g,"<br>"),l.insertNode(i),l.collapse(!1),l.setEnd(c,2)}else c.value=c.value.slice(0,c.selectionStart)+r[a]+c.value.slice(c.selectionEnd),J(c,["input"]),c.focus();break}}));break;case"showWizard":var s=self===top;H(),y=n.data.editable?(s&&!n.data.frame||n.data.frame)&&e.activeElement.matches(l)?ue(e.activeElement):null:void 0,s&&(window.AF_WIZARD={editable:n.data.editable,siteHaystack:u,type:n.data.type}),e.getElementById("autofill-wizard")?(Wizard.updateText(),a({css:!!e.autofillCssInjected,open:!0})):s&&(a({css:!!e.autofillCssInjected,open:!1}),e.autofillCssInjected=!0);break;case"sync":if(!b)return;var f=b.other.backup;R().then((function(){b.other.backup!==f&&T(de(l),!0)}),(function(e){var n="["+t+"] "+e;b?E&&console.warn(n):console.error(n)}))}}f&&(window.innerWidth>1||window.innerHeight>1)&&(R().then((function(){var t=de(l),n=b.other.delay?b.delay:0;me(t.length,0),T(t),e.body.hasAttribute("jsaction")&&e.body.className.indexOf("freebird")>-1&&n<.5&&(n=.5),setTimeout((function(){Autofill(null,!0)}),250),A||(n?setTimeout(Autofill,1e3*n):Autofill(t)),F(e)}),(function(e){var n="["+t+"] "+e;b?E&&console.warn(n):console.error(n)})),chrome.runtime.onMessage.addListener(ke),self!==top||top.FencedFrameElement||window.addEventListener("beforeunload",we));
